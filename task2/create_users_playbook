- name: remove httpd and close ports
  hosts: nodes
  vars:
    - users:
        - name: Alice
          pass: !vault |
                $ANSIBLE_VAULT;1.1;AES256
                63363564373231383861666365353237663231373331616432613930636263316134346561636464
                3638653866646437643961373737323332656165346236620a666466383338386263386539623337
                37386638633766313462656432363238646432663737366661336563383362353832363037396432
                6366376164666639350a643535376335323035313932623364393130396661613033616434396363
                3661
        - name: Bob
          pass: !vault |
                $ANSIBLE_VAULT;1.1;AES256
                33663236393034393166353462376233343636653562386638373737633361653466323830623737
                3064353961383536353363373962653632663737326137300a356631633335363836343536343466
                32643866366139633238633161386331663731323730303739323865623661356563623836316264
                3037656130386231310a323361303336316166373661336235383538363764306639386466313862
                3664
        - name: Carol
          pass: !vault |
                $ANSIBLE_VAULT;1.1;AES256
                65316430353239663337306237323461623466303734316335373932633636363230306663363432
                3737656435376131663439393039346437323865396435380a313930336561353335366230623763
                36383965663437396364613561633361613965333638306666663966626631626232663666353435
                3064303830643665630a636132643364333332663265356532353231376232646235616439613539
                6138
  tasks:
    - name: Creating users
      user:
        name: "{{ item.name }}"
        comment: "{{ item.name }}@example.com"
        home: /home/{{ item.name }}
        create_home: yes
        password: "{{ item.pass | password_hash('sha512', 'salt123456789') }}"
        update_password: on_create
      loop: "{{ users }}"
